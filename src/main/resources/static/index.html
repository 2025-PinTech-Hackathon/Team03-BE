<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>WebSocket ì—°ê²° í™•ì¸</title>
</head>
<body>
<h2>ğŸ”Œ WebSocket ì—°ê²° ìƒíƒœ: <span id="status">ì—°ê²° ì•ˆ ë¨</span></h2>
<ul id="messages"></ul>

<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
<script>
    const socket = new SockJS("/ws");
    const stomp = Stomp.over(socket);

    const childId = "2"; // ì‹¤ì œ ìë…€ IDë¡œ ë°”ê¾¸ì„¸ìš”

    stomp.connect({}, () => {
        document.getElementById("status").innerText = "WebSocket ì—°ê²° ì„±ê³µ!";

        // í€˜ìŠ¤íŠ¸ ë©”ì‹œì§€ êµ¬ë…
        stomp.subscribe(`/topic/child/${childId}`, (message) => {
            const data = JSON.parse(message.body);
            const li = document.createElement("li");
            li.innerText = `í€˜ìŠ¤íŠ¸ ë„ì°©: ${data.title} (ë³´ìƒ: ${data.reward}ì›)`;
            document.getElementById("messages").appendChild(li);
        });
    }, () => {
        document.getElementById("status").innerText = "ì—°ê²° ì‹¤íŒ¨";
    });
</script>
</body>
</html>
